!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=this;return t+=" check the documentation at https://www.360-javascriptviewer.com/installation",(n=e.call(this,t)||this).name="360 Javascript Viewer InputError",n}return i(t,e),t}(Error);t.default=o},function(e,t,n){"use strict";function r(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=Math.atan2(r,n);return i>=0?i:i+2*Math.PI}function i(e,t,n){var r=e.clientX,i=e.clientY;return{clientX:r,clientY:i,deltaX:r-t.clientX,deltaY:i-t.clientY,distX:r-n.clientX,distY:i-n.clientY}}function o(e){for(var t=Math.min(e.length,2),n=[],r=0;r<t;++r)n.push(a(e[r]));return n}function a(e){return{clientX:e.clientX,clientY:e.clientY}}function s(e){return 1===e.length?e[0]:{clientX:(e[0].clientX+e[1].clientX)/2,clientY:(e[0].clientY+e[1].clientY)/2}}function u(e,t){return{clientX:e.clientX+t.clientX,clientY:e.clientY+t.clientY}}function c(e,t){return{clientX:e.clientX-t.clientX,clientY:e.clientY-t.clientY}}Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.removeEvent=t.addEvent=t.minusClient=t.plueClient=t.getAverageClient=t.getClient=t.getClients=t.getPositions=t.getDist=t.getPosition=t.getPositionEvent=t.isMultiTouch=t.getPinchDragPosition=t.getRotation=t.getRandomId=t.getRad=void 0,t.getRad=r,t.getRandomId=function(){return"_"+Math.random().toString(36).substr(2,9)},t.getRotation=function(e){return r([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180},t.getPinchDragPosition=function(e,t,n,r){var o=s(e),a=s(t),l=s(r);return i(u(r[0],c(o,l)),u(r[0],c(a,l)),n[0])},t.isMultiTouch=function(e){return e.touches&&e.touches.length>=2},t.getPositionEvent=function(e){return e.touches?o(e.touches):[a(e)]},t.getPosition=i,t.getDist=function(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))},t.getPositions=function(e,t,n){return e.map((function(e,r){return i(e,t[r],n[r])}))},t.getClients=o,t.getClient=a,t.getAverageClient=s,t.plueClient=u,t.minusClient=c,t.addEvent=function(e,t,n,r){e.addEventListener(t,n,r)},t.removeEvent=function(e,t,n){e.removeEventListener(t,n)},t.now=function(){return Date.now?Date.now():(new Date).getTime()}},function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(2),s=function(){throw new Error("Slot not connected")};t.defaultSlotConfig={noBuffer:!1};var u=function(e){return Object.assign((function(){return s()}),{config:e,lazy:function(){return s},on:function(){return s},slotName:"Not connected"})},c=function(e,t){return Object.keys(t).reduce((function(n,r){return n.concat(t[r][e]||[])}),[])},l=function(e){return Object.keys(e).reduce((function(t,n){var r=e[n],o=Object.keys(r).filter((function(e){return(r[e]||[]).length>0})),a=[].concat(i(t),i(o));return[].concat(i(new Set(a)))}),[])};t.slot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.defaultSlotConfig;return u(e)},t.connectSlot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t.reduce((function(e,t,n){return Object.assign({},e,r({},n,{}))}),r({},"LOCAL_TRANSPORT",{})),u=t.reduce((function(e,t,n){return Object.assign({},e,r({},n,{}))}),{}),h=function(e,t){var n=function(){},r=new Promise((function(e){return n=e}));u[e][t]={registered:r,onRegister:n}},d=[],f=[],g=function(e){return d.forEach((function(t){return t(e)}))},p=function(e){return f.forEach((function(t){return t(e)}))};function m(e,r){var l=2===arguments.length,d=l?r:e,f=l?e:a.DEFAULT_PARAM;if(n.noBuffer||0===t.length){var g=c(f,s);return o.callHandlers(d,g)}t.forEach((function(e,t){u[t][f]||h(String(t),f)}));var p=t.reduce((function(e,t,n){return[].concat(i(e),[u[n][f].registered])}),[]);return Promise.all(p).then((function(){var e=c(f,s);return o.callHandlers(d,e)}))}function v(e,t){return d.push(e),f.push(t),l(s).forEach(e),function(){l(s).forEach(t);var n=d.indexOf(e);n>-1&&d.splice(n,1);var r=f.indexOf(t);r>-1&&f.splice(r,1)}}function y(n,r){var i="",o=function(){return new Promise((function(e){return e()}))};return"string"==typeof n?(i=n,o=r||o):(i=a.DEFAULT_PARAM,o=n),t.forEach((function(t){return t.registerHandler(e,i,o)})),s.LOCAL_TRANSPORT[i]=(s.LOCAL_TRANSPORT[i]||[]).concat(o),1===c(i,s).length&&g(i),function(){t.forEach((function(t){return t.unregisterHandler(e,i,o)}));var n=(s.LOCAL_TRANSPORT[i]||[]).indexOf(o);-1!==n&&s.LOCAL_TRANSPORT[i].splice(n,1),0===c(i,s).length&&p(i)}}return t.forEach((function(t,n){t.addRemoteHandlerRegistrationCallback(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.DEFAULT_PARAM,t=arguments[1],r=s[n][e]||[];s[n][e]=r.concat(t),1===c(e,s).length&&g(e),u[n][e]||h(String(n),e),u[n][e].onRegister()})),t.addRemoteHandlerUnregistrationCallback(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.DEFAULT_PARAM,t=arguments[1],r=s[n][e]||[],i=r.indexOf(t);i>-1&&s[n][e].splice(i,1),0===c(e,s).length&&p(e),h(String(n),e)}))})),Object.assign(m,{on:y,lazy:v,config:n,slotName:e})}},function(e,t,n){"use strict";function r(e,t){var n=null;try{n=e(t)}catch(e){return Promise.reject(e)}return n&&n.then?n:Promise.resolve(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.callHandlers=function(e,t){return t&&0!==t.length?1===t.length?r(t[0],e):Promise.all(t.map((function(t){return r(t,e)}))):new Promise((function(e){}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PARAM="$_DEFAULT_$"},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;i(this,e),this._timeout=t,this._onMessageCallbacks=[],this._onConnectCallbacks=[],this._onDisconnectCallbacks=[],this._onErrorCallbacks=[],this._ready=!1}return r(e,[{key:"onData",value:function(e){-1===this._onMessageCallbacks.indexOf(e)&&this._onMessageCallbacks.push(e)}},{key:"onConnect",value:function(e){this._ready&&e(),this._onConnectCallbacks.push(e)}},{key:"onDisconnect",value:function(e){this._onDisconnectCallbacks.push(e)}},{key:"onError",value:function(e){this._onErrorCallbacks.push(e)}},{key:"_messageReceived",value:function(e){this._onMessageCallbacks.forEach((function(t){return t(e)}))}},{key:"_error",value:function(e){this._onErrorCallbacks.forEach((function(t){return t(e)}))}},{key:"_connected",value:function(){this._ready=!0,this._onConnectCallbacks.forEach((function(e){return e()}))}},{key:"_disconnected",value:function(){this._ready=!1,this._onDisconnectCallbacks.forEach((function(e){return e()}))}},{key:"timeout",get:function(){return this._timeout}}]),e}();t.GenericChannel=o},function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.slot=r.slot;var i=n(6);t.combineEvents=i.combineEvents,t.createEventBus=i.createEventBus;var o=n(3);t.GenericChannel=o.GenericChannel;var a=n(8);t.ChunkedChannel=a.ChunkedChannel;var s=n(2);t.DEFAULT_PARAM=s.DEFAULT_PARAM},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=n(7);t.combineEvents=function(e,t,n,i,o,a,s,u,c,l,h,d,f,g,p,m,v,y,b,w,_,I,E,D){var R=Array.from(arguments),C=R.reduce((function(e,t){return[].concat(r(e),r(Object.keys(t)))}),[]),k=[].concat(r(new Set(C)));if(C.length>k.length)throw new Error("ts-event-bus: duplicate slots encountered in combineEvents.");return Object.assign.apply(Object,[{}].concat(r(R)))},t.createEventBus=function(e){var t=(e.channels||[]).map((function(e){return new o.Transport(e)}));return Object.keys(e.events).reduce((function(n,r){var o=e.events[r].config;return n[r]=i.connectSlot(r,t,o),n}),{})}},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=0,a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._channel=t,this._localHandlers={},this._localHandlerRegistrations={},this._remoteHandlers={},this._remoteHandlerRegistrationCallbacks={},this._remoteHandlerDeletionCallbacks={},this._pendingRequests={},this._channelReady=!1,this._channel.onData((function(e){switch(e.type){case"request":return n._requestReceived(e);case"response":return n._responseReceived(e);case"handler_registered":return n._registerRemoteHandler(e);case"handler_unregistered":return n._unregisterRemoteHandler(e);case"error":return n._errorReceived(e);default:!function(e){throw new Error("Should not happen: "+e)}(e)}})),this._channel.onConnect((function(){n._channelReady=!0,Object.keys(n._localHandlerRegistrations).forEach((function(e){n._localHandlerRegistrations[e].forEach((function(e){n._channel.send(e)}))}))})),this._channel.onDisconnect((function(){n._channelReady=!1,n._unregisterAllRemoteHandlers(),n._rejectAllPendingRequests(new Error("REMOTE_CONNECTION_CLOSED"))})),this._channel.onError((function(e){return n._rejectAllPendingRequests(e)}))}return r(e,[{key:"_requestReceived",value:function(e){var t=this,n=e.slotName,r=e.data,o=e.id,a=e.param,s=this._localHandlers[n];if(s){var u=s[a];u&&i.callHandlers(r,u).then((function(e){return t._channel.send({type:"response",slotName:n,id:o,data:e,param:a})})).catch((function(e){return t._channel.send({id:o,message:""+e,param:a,slotName:n,stack:e.stack||"",type:"error"})}))}}},{key:"_responseReceived",value:function(e){var t=e.slotName,n=e.data,r=e.id,i=e.param,o=this._pendingRequests[t];o&&o[i]&&o[i][r]&&(o[i][r].resolve(n),delete o[i][r])}},{key:"_errorReceived",value:function(e){var t=e.slotName,n=e.id,r=e.message,i=e.stack,o=e.param,a=this._pendingRequests[t];if(a&&a[o]&&a[o][n]){var s=new Error(r+" on "+t+" with param "+o);s.stack=i||s.stack,this._pendingRequests[t][o][n].reject(s),delete this._pendingRequests[t][o][n]}}},{key:"_registerRemoteHandler",value:function(e){var t=this,n=e.slotName,r=e.param,i=this._remoteHandlerRegistrationCallbacks[n];if(i){var a=this._remoteHandlers[n];if(!a||!a[r]){var s=function(e){return new Promise((function(i,a){if(!t._channelReady)return a(new Error("CHANNEL_NOT_READY on "+n));var s=""+o++;t._pendingRequests[n]=t._pendingRequests[n]||{},t._pendingRequests[n][r]=t._pendingRequests[n][r]||{},t._pendingRequests[n][r][s]={resolve:i,reject:a},t._channel.send({type:"request",id:s,slotName:n,param:r,data:e}),setTimeout((function(){var e=((t._pendingRequests[n]||{})[r]||{})[s];if(e){var i=new Error("TIMED_OUT on "+n+" with param "+r);e.reject(i),delete t._pendingRequests[n][r][s]}}),t._channel.timeout)}))};this._remoteHandlers[n]=this._remoteHandlers[n]||{},this._remoteHandlers[n][r]=s,i(r,s)}}}},{key:"_unregisterRemoteHandler",value:function(e){var t=e.slotName,n=e.param,r=this._remoteHandlerDeletionCallbacks[t],i=this._remoteHandlers[t];if(i){var o=i[n];o&&r&&(r(n,o),delete this._remoteHandlers[t][n])}}},{key:"_unregisterAllRemoteHandlers",value:function(){var e=this;Object.keys(this._remoteHandlerDeletionCallbacks).forEach((function(t){var n=e._remoteHandlers[t];n&&Object.keys(n).filter((function(e){return n[e]})).forEach((function(n){return e._unregisterRemoteHandler({slotName:t,param:n})}))}))}},{key:"_rejectAllPendingRequests",value:function(e){var t=this;Object.keys(this._pendingRequests).forEach((function(n){Object.keys(t._pendingRequests[n]).forEach((function(r){Object.keys(t._pendingRequests[n][r]).forEach((function(i){t._pendingRequests[n][r][i].reject(e)}))})),t._pendingRequests[n]={}}))}},{key:"addRemoteHandlerRegistrationCallback",value:function(e,t){this._remoteHandlerRegistrationCallbacks[e]||(this._remoteHandlerRegistrationCallbacks[e]=t)}},{key:"addRemoteHandlerUnregistrationCallback",value:function(e,t){this._remoteHandlerDeletionCallbacks[e]||(this._remoteHandlerDeletionCallbacks[e]=t)}},{key:"registerHandler",value:function(e,t,n){if(this._localHandlers[e]=this._localHandlers[e]||{},this._localHandlers[e][t]=this._localHandlers[e][t]||[],this._localHandlers[e][t].push(n),1===this._localHandlers[e][t].length){var r={type:"handler_registered",param:t,slotName:e};this._localHandlerRegistrations[t]=this._localHandlerRegistrations[t]||[],this._localHandlerRegistrations[t].push(r),this._channelReady&&this._channel.send(r)}}},{key:"unregisterHandler",value:function(e,t,n){var r=this._localHandlers[e];if(r&&r[t]){var i=r[t].indexOf(n);if(i>-1&&(r[t].splice(i,1),0===r[t].length)){var o={type:"handler_unregistered",param:t,slotName:e};this._channelReady&&this._channel.send(o)}}}}]),e}();t.Transport=a},function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),a=n(9),s=function(e){if(!e.chunkId)throw new Error("ChunkedMessage did not have a chunkId: "+JSON.stringify(e))},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.timeout));return n._buffer={},n._chunkSize=e.chunkSize,n._sender=e.sender,n._maxStringAlloc=e.maxStringAlloc||-1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"send",value:function(e){var t=this,n=JSON.stringify(e);if(n.length<=this._chunkSize)this._sender(e);else{var r=function(e){for(var t=new Uint16Array(e.length),n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t}(n),i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array(30))).map((function(){return Math.random().toString(36)[3]})).join("");this._sender({type:"chunk_start",chunkId:i,size:n.length}),!function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=r.slice(n,n+t._chunkSize);o.length&&(t._sender({type:"chunk_data",chunkId:i,data:Array.from(o)}),e(n+t._chunkSize))}(),this._sender({type:"chunk_end",chunkId:i})}}},{key:"_messageReceived",value:function(e){switch(e.type){case"chunk_start":this._receiveNewChunk(e);break;case"chunk_data":this._receiveChunkData(e);break;case"chunk_end":var n=this._mergeChunks(e);i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_messageReceived",this).call(this,n);break;default:i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_messageReceived",this).call(this,e)}}},{key:"_receiveNewChunk",value:function(e){if(s(e),this._buffer[e.chunkId])throw new Error("There was already an entry in the buffer for chunkId "+e.chunkId);this._buffer[e.chunkId]={id:e.chunkId,chunks:[],size:e.size}}},{key:"_receiveChunkData",value:function(e){if(s(e),!this._buffer[e.chunkId])throw new Error("ChunkId "+e.chunkId+" was not found in the buffer");this._buffer[e.chunkId].chunks.push(e.data)}},{key:"_mergeChunks",value:function(e){if(s(e),!this._buffer[e.chunkId])throw new Error("ChunkId "+e.chunkId+" was not found in the buffer");var t=this._buffer[e.chunkId].chunks.reduce((function(e,t,n){return t.forEach((function(t,n){return e.uintArray[e.currentIx+n]=t})),e.currentIx+=t.length,e}),{uintArray:new Uint16Array(this._buffer[e.chunkId].size),currentIx:0}),n=void 0,r=function(e,t){if(-1===t)return String.fromCharCode.apply(null,e);for(var n="",r=0;r<e.length;r+=t)r+t>e.length?n+=String.fromCharCode.apply(null,e.subarray(r)):n+=String.fromCharCode.apply(null,e.subarray(r,r+t));return n}(t.uintArray,this._maxStringAlloc);try{n=JSON.parse(r)}catch(e){throw new Error("Not a valid JSON string: "+r)}if(!a.isTransportMessage(n))throw new Error("Not a transport message: "+JSON.stringify(n));return n}}]),t}(o.GenericChannel);t.ChunkedChannel=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransportMessage=function(e){switch(e.type){case"request":case"response":case"error":case"handler_unregistered":case"handler_registered":return!0;default:return!1}}}])},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.JavascriptViewer=void 0;var a=n(4),s=n(7),u=n(1),c=n(8),l=n(2),h=n(9),d=n(10),f=n(0),g={mainImageId:"jsv-image",mainHolderId:"jsv-holder",totalFrames:72,speed:80,inertia:20,defaultProgressBar:!0,firstImageNumber:1,imageUrlFormat:"",startFrameNo:1,reverse:!1,verbose:!1,autoRotate:0,autoRotateSpeed:0,autoRotateReverse:!1},p=function(){function e(e){this.isStarted=!1,this.isDragged=!1,this.images=[],this.currentImageNumber=1,this.previousImageNumber=1,this.desiredRotationInDegrees=0,this.mainImage=null,this.mainHolderElement=null,this.uniqueId="",this.currentDegree=0,this.inAnimation=!1,this.desiredRotationInDegreesStartSlowingDown=null,this.useEasing=!0,this.updateInAction=!1,this.window=null,this.startDragInvocations=0,this.firstDrag=!1,this.standbyRefreshRate=40,this.previousTargetDegree=0,this.nAutoRotations=0,this.options=r(r({},g),e),this.eventBus=l.createEventBus({events:h.default,channels:[]}),this.runningInBrowser()&&(this.window="undefined"!=typeof window?window:null)}return e.prototype.runningInBrowser=function(){return"undefined"!=typeof window},e.prototype.events=function(){return this.eventBus},e.prototype.setSpeed=function(e){this.options.speed=e>99?99:e<1?1:e},e.prototype.setInertia=function(e){this.options.inertia=e>99?99:e<1?1:e},e.prototype.initProgressBar=function(){if(this.options.defaultProgressBar){a.Images.blurMainImage(this.options.mainImageId,this.window);var e=a.Images.createProgressBar(this.uniqueId,this.window,this.mainHolderElement),t=e[0],n=e[1],r=new d.default(0,t.firstChild);this.eventBus.loadImage.on((function(e){r.update(e.percentage)})),this.eventBus.started.on((function(){t.style.display="none",n.style.display="none"}))}},e.prototype.documentIsReady=function(){return"complete"===this.window.document.readyState},e.prototype.track=function(){if(!this.isLocalhost()){var e=btoa(this.window.location.href),t=new XMLHttpRequest;t.open("GET","https://www.360-javascriptviewer.com/tracking?t="+e,!0),t.send()}},e.prototype.isLocalhost=function(){var e=this.window.location.hostname,t=this.window.location.port;return Boolean(-1!==e.indexOf("dev.")||-1!==e.indexOf("beta.")||-1!==e.indexOf("file")||""!==t||"localhost"===e||"[::1]"===e||e.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))},e.prototype.showFirst=function(){var e=this.images[this.getFirstImageIndex()];s.DomUtilities.showImage(e,this.window)},e.prototype.getFirstImageIndex=function(){return this.options.firstImageNumber&&this.options.firstImageNumber>0&&this.options.firstImageNumber-1<this.images.length?this.options.firstImageNumber-1:0},e.prototype.destroy=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t,n){try{if(e.isStarted){var r=e.window.document.getElementById(e.uniqueId);if(r&&s.DomUtilities.removeElement(r),e.options.defaultProgressBar){var i=e.window.document.getElementById("loader_"+e.uniqueId);s.DomUtilities.removeElement(i);var o=e.window.document.getElementById("link_"+e.uniqueId);s.DomUtilities.removeElement(o)}s.DomUtilities.showImage(e.mainImage,e.window),e.isStarted=!1,e.images=[],e.mainImage=null,e.mainHolderElement=null,t(!0)}else t(!1)}catch(e){n(e.message)}}))]}))}))},e.prototype.start=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){switch(t.label){case 0:return this.documentIsReady()?[3,2]:[4,new Promise((function(e){setTimeout((function(){e()}),1e3)})).then((function(){return e.start}))];case 1:t.sent(),t.label=2;case 2:return[2,new Promise((function(t,n){try{return e.isStarted&&n("Viewer "+e.uniqueId+" already started"),e.runningInBrowser()||n("Viewer "+e.uniqueId+" not started in browser"),e.options.autoRotate>0&&e.eventBus.started.on((function(t){t?e.autoRotate(e.options.autoRotate).then((function(){e.eventBus.endAutoRotate({currentDegree:e.currentDegree,currentImage:e.images[e.currentImageNumber-1],completed:!0})})).catch((function(){e.eventBus.endAutoRotate({currentDegree:e.currentDegree,currentImage:e.images[e.currentImageNumber-1],completed:!1})})):e.destroy().then((function(){e.reportWarning("Failed starting autorotate")})).catch((function(t){return e.reportError(t)}))})),e.eventBus.started.on((function(n){if(n)return e.track(),t();e.destroy().then((function(){e.reportWarning("Failed starting viewer, returned to default state")})).catch((function(t){return e.reportError(t)}))})),e.mainImage=a.Images.getMainImage(e.options.mainImageId,e.window),e.mainHolderElement=s.DomUtilities.getMainHolderElement(e.options.mainHolderId,e.window),e.uniqueId=e.uniqueId||u.getRandomId(),0===e.images.length?(e.initProgressBar(),e.getImages().then((function(t){return i(e,void 0,void 0,(function(){var e,r=this;return o(this,(function(i){switch(i.label){case 0:return this.images=t,e=s.DomUtilities.getImageHolderElement(this.window,this.mainHolderElement,this.uniqueId),this.mainHolderElement.onmouseleave=function(){r.isDragged=!1},[4,this.prepareImageHolder(e).then((function(e){r.mainHolderElement.appendChild(e),s.DomUtilities.hideImageSlow(r.mainImage,r.window).then((function(){r.inAnimation||(s.DomUtilities.showImage(r.images[r.getFirstImageIndex()],r.window),r.currentImageNumber=r.options.firstImageNumber||1,r.previousImageNumber=r.options.firstImageNumber||1,r.setCurrentDegree(r.currentImageNumber)),r.isStarted=!0,r.eventBus.started(!0)})).catch((function(e){return console.log("error when preparing",e)}))})).catch((function(e){r.eventBus.started(!1),n(e)}))];case 1:return i.sent(),[2]}}))}))})).catch((function(t){e.eventBus.started(!1),e.reportError(t),n(t)}))):n("there are already some images")}catch(t){e.reportError(t.message)}}))]}}))}))},e.prototype.prepareImageHolder=function(e){return i(this,void 0,void 0,(function(){function t(e,t){return i(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<e.length?[4,t(e[n],n,e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))}var n=this;return o(this,(function(r){return[2,new Promise((function(r,a){return i(n,void 0,void 0,(function(){var n,i,a=this;return o(this,(function(o){switch(o.label){case 0:return n=[],i=function(t,n){new c.default(t,{container:a.mainHolderElement,dragstart:a.dragStart.bind(a),dragend:a.dragEnd.bind(a),drag:a.drag.bind(a),events:["mouse","touch"]}),a.images[n].encoded="",e.appendChild(t)},[4,t(this.images,(function(e,t){var r=s.DomUtilities.getImageElement(e,a.window);n[n.length]=r.decode().then((function(){i.call(a,r,t)})).catch((function(e){a.reportWarning(e),i.call(a,r,t)}))}))];case 1:return o.sent(),Promise.all(n).then((function(){r(e)})),[2]}}))}))}))]}))}))},e.prototype.reportError=function(e){console.error("360 Javascript Viewer: "+e);var t=btoa(e),n=new XMLHttpRequest;n.open("GET","https://www.360-javascriptviewer.com/err?t="+t,!0),n.send()},e.prototype.reportWarning=function(e){this.options.defaultProgressBar&&console.warn("360 Javascript Viewer: "+e)},e.prototype.updateImage=function(){var e=this;this.updateInAction=!0;var t;return 0===this.desiredRotationInDegrees?(this.inAnimation=!1,this.updateInAction=!1,this.desiredRotationInDegreesStartSlowingDown=null,new Promise((function(t){t({currentDegree:e.currentDegree})}))):(this.setCurrentImage(this.getNextImageNumber()),(t=this.getCurrentRefreshRate(),new Promise((function(e){return setTimeout(e,t)}))).then((function(){return e.updateImage()})))},e.prototype.rotateDegrees=function(e){return this.inAnimation=!0,this.desiredRotationInDegrees=e,this.updateImage()},e.prototype.rotateToDegree=function(e,t,n){var r=this;if(void 0===t&&(t=!0),void 0===n&&(n=!0),this.inAnimation=!0,this.cancelCurrentActions(),this.useEasing=n,this.desiredRotationInDegrees=0,e=Math.round(e),this.previousTargetDegree===e||e===this.currentDegree)return new Promise((function(e){e({currentDegree:r.currentDegree})}));this.inAnimation=!0;var i=e>this.currentDegree?e-this.currentDegree:360-this.currentDegree+e,o=e<this.currentDegree?-1*(this.currentDegree-e):-1*(this.currentDegree+(360-e));return this.desiredRotationInDegrees=t&&Math.abs(o)<i?o:i,this.previousTargetDegree=e,this.updateImage()},e.prototype.cancelCurrentActions=function(){this.desiredRotationInDegrees=0,this.previousTargetDegree=0,this.nAutoRotations=0},e.prototype.dragEnd=function(){this.isDragged=!1},e.prototype.drag=function(e){if(!this.isDragged)return!1;var t=(100-this.options.inertia)/100,n=e.deltaX*t*-1;return this.options.reverse&&(n*=-1),this.desiredRotationInDegrees+=n,this.updateInAction||this.updateImage(),this.firstDrag&&(this.startDragInvocations++,this.eventBus.startDragging({invocations:this.startDragInvocations}),this.firstDrag=!1),this.isDragged},e.prototype.dragStart=function(){this.isDragged=!0,this.firstDrag=!0,this.cancelCurrentActions()},e.prototype.getNextImageNumber=function(){var e=this.images.length,t=this.getDegreesOneImage(),n=this.currentImageNumber;return Math.abs(this.desiredRotationInDegrees)<t||(n=this.desiredRotationInDegrees>0?this.increaseImageNumber(n,e):this.decreaseImageNumber(n,e),this.decreaseDesiredRotation(t),this.setCurrentDegree(n)),n},e.prototype.getDegreesOneImage=function(){var e=this.images.length;return Math.round(360/e)},e.prototype.setCurrentDegree=function(e){var t=this.getDegreesOneImage();this.currentDegree=1===e?0:(e-1)*t},e.prototype.decreaseImageNumber=function(e,t){return--e<1?t:e},e.prototype.increaseImageNumber=function(e,t){return++e>t?1:e},e.prototype.decreaseDesiredRotation=function(e){e=Math.abs(e),this.desiredRotationInDegrees<0?this.desiredRotationInDegrees+=e:this.desiredRotationInDegrees-=Math.abs(e),Math.abs(this.desiredRotationInDegrees)<e&&(this.desiredRotationInDegrees=0)},e.prototype.setCurrentImage=function(e){e!==this.previousImageNumber&&this.isStarted&&(-1!==this.previousImageNumber&&s.DomUtilities.hideImage(this.images[this.previousImageNumber-1],this.window),s.DomUtilities.showImage(this.images[e-1],this.window),this.previousImageNumber=e,this.currentImageNumber=e)},e.prototype.viewerHasNoAction=function(){return!this.isDragged},e.prototype.getImages=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2,a.Images.getPossibleImages(this.mainImage.src,this.getTotalFrames(),this.uniqueId,this.eventBus,this.options.imageUrlFormat,this.options.startFrameNo)]}))}))},e.prototype.getTotalFrames=function(){var e=this.options.totalFrames;if(e>0&&e<=360)return e;throw new f.default("totalFrames must be between 1 and 360 now "+e)},e.prototype.speedToRefreshRate=function(e){return(100-e)/2},e.prototype.getCurrentRefreshRate=function(){if(0===this.desiredRotationInDegrees)return this.standbyRefreshRate;if(this.viewerHasNoAction()&&this.useEasing){this.desiredRotationInDegreesStartSlowingDown||(this.desiredRotationInDegreesStartSlowingDown=Math.abs(this.desiredRotationInDegrees));var e=(1-(1-Math.abs(this.desiredRotationInDegrees)/this.desiredRotationInDegreesStartSlowingDown))*this.options.speed;return this.speedToRefreshRate(e)}return this.speedToRefreshRate(this.options.speed)},e.prototype.autoRotate=function(e){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){return this.nAutoRotations=e,[2,new Promise((function(n,r){return i(t,void 0,void 0,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:this.useEasing=!1,(t=this.options.autoRotateSpeed!==this.options.speed)&&(console.log("use diff speed",this.options.autoRotateSpeed,this.options.speed),this.setSpeed(this.options.autoRotateSpeed)),i=0,o.label=1;case 1:return i<this.nAutoRotations?this.isDragged||this.nAutoRotations!==e?(r("auto rotate was interrupted"),t&&this.setSpeed(this.options.speed),[3,4]):(i===e-1&&(this.useEasing=!0),this.desiredRotationInDegrees=this.options.autoRotateReverse?-360:360,[4,this.updateImage()]):[3,4];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return t&&this.setSpeed(this.options.speed),this.nAutoRotations===e?n():r(),[2]}}))}))}))]}))}))},e}();t.JavascriptViewer=p},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Images=void 0;var o=n(0),a=n(5),s=function(){function e(){}return e.getFilename=function(e,t,n){var r=n.split(".").pop();if(0===t.length){var i=(e<10?"0":"")+e.toString();return n.replace("."+r,"_"+i+"."+r)}var a=this.getImagesPath(n),s=this.getImagesPath(t)||a,u=t.lastIndexOf("/")+1;if(-1!==(t=t.substr(u)).toLowerCase().indexOf("xx")){i=(e<10?"0":"")+e.toString();return""+s+t.replace("xx",i)}if(-1!==t.toLowerCase().indexOf("x")){i=e.toString();return""+s+t.replace("x",i)}throw new o.default("no placeholder x or xx found in format: "+t)},e.getPossibleImages=function(e,t,n,o,s,u){return r(this,void 0,void 0,(function(){var r=this;return i(this,(function(i){return[2,new Promise((function(i,c){var l=[];0===e.length&&i(l);for(var h=[],d=u;t>l.length;d++){var f=r.getFilename(d,s,e);l.push({src:f,id:n+d.toString(),encoded:""}),h.push(f)}var g=1;a.default(h,{toBase64:!0,inBackground:!0,order:a.Order.AllAtOnce,onSingleImageComplete:function(e){l[h.indexOf(e.url)].encoded=e.result,o.loadImage({currentImage:g,totalImages:t,percentage:Math.round(g/t*100),image:l[g-1]}),g++},onSingleImageFail:function(e){console.warn("Failed loading image, are you using a good imageUrlFormat? ",e)}}).then((function(){g-1===h.length?i(l):c("Not all images are loaded "+(g-1)+" from "+h.length+". \n                    Check the warning to see the image urls we are trying to fetch")})).catch((function(e){c(e)}))}))]}))}))},e.getMainImage=function(e,t){var n=t.document.getElementById(e);if(n instanceof HTMLImageElement)return{src:n.src,id:e};throw new o.default('Could not find main image with id "'+e+'"')},e.getMainImageElement=function(e,t){var n=t.document.getElementById(e);if(n instanceof HTMLImageElement)return n;throw new o.default('Could not find main image with id "'+e+'"')},e.blurMainImage=function(e,t){var n=t.document.getElementById(e);n instanceof HTMLImageElement&&(n.style.filter="blur(5px)")},e.createProgressBar=function(e,t,n){var r=t.document.createElement("div");r.style.display="flex",r.style.height="5px",r.style.width="30%",r.style.overflow="hidden",r.style.backgroundColor="#e9ecef",r.style.borderRadius="0.25rem",r.id="loader_"+e,r.style.position="absolute",r.style.zIndex="200",r.style.top=n.clientHeight/2+"px",r.style.marginLeft="auto",r.style.marginRight="auto",r.style.left="0",r.style.right="0";var i="https://www.360-javascriptviewer.com/?utm_source=presentation&utm_medium=preloader&utm_campaign="+t.location.hostname,o=t.document.createElement("a");o.text="360 javascript viewer",o.href=i,o.id="link_"+e,o.target="_blank",o.style.position="absolute",o.style.zIndex="200",o.style.top=n.clientHeight/2-15+"px",o.style.marginLeft="auto",o.style.marginRight="auto",o.style.left="0",o.style.right="0",o.style.width="30%",o.style.whiteSpace="nowrap",o.style.fontSize="10px",o.style.textAlign="center",o.style.color="#6a6d71",o.style.textDecoration="none";var a=t.document.createElement("div");return a.style.backgroundColor="#6a6d71",r.appendChild(a),n.appendChild(o),n.appendChild(r),[r,o]},e.getImagesPath=function(e){var t=e.replace(/^.*[\\/]/,"");return e.substring(0,e.length-t.length)},e}();t.Images=s},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.Order=void 0;var s,u=n(6);!function(e){e[e.AllAtOnce=0]="AllAtOnce",e[e.InOrder=1]="InOrder"}(s||(s={})),t.Order=s;var c={order:s.InOrder,timeout:0,shouldContinueOnFail:!0,toBase64:!1,inBackground:!1,onSingleImageFail:function(){},onSingleImageComplete:function(){},onComplete:function(){}};function l(e){return new Promise((function(t){return setTimeout(t,e)}))}t.default=function(e,t){return i(this,void 0,void 0,(function(){function n(e){return new Promise((function(t,n){var r=document.createElement("img");r.setAttribute("src",e),r.addEventListener("load",(function(n){d.onSingleImageComplete(n,e),t(n)})),r.addEventListener("error",(function(e){d.onSingleImageFail(e),n(e)}))}))}function h(e){return i(this,void 0,void 0,(function(){var t,r,i;return o(this,(function(o){switch(o.label){case 0:if(!d.inBackground)return[3,4];t=u.default((function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.send(),r.addEventListener("load",(function(){var i=new FileReader;i.readAsDataURL(r.response),i.addEventListener("loadend",(function(o){200===r.status?t({result:i.result,url:e,val:r.status}):n(e)}))})),r.addEventListener("error",(function(e){n(e)}))}))})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t(e)];case 2:return r=o.sent(),[2,d.onSingleImageComplete(r)];case 3:return i=o.sent(),[2,d.onSingleImageFail(i)];case 4:return[4,n(e)];case 5:return[2,o.sent()]}}))}))}var d,f,g,p,m,v,y;return o(this,(function(n){switch(n.label){case 0:if((d=r(r({},c),t||{})).timeout&&d.order===s.AllAtOnce)throw new Error("Invalid options: Cannot specify `timeout` options and `AllAtOnce` order.");if(!d.toBase64&&d.inBackground)throw new Error("Invalid options: If `inBackground` options is true `toBase64` options must be true as well.");if(d.toBase64&&!d.inBackground)throw new Error("Invalid options: If `inBackground` options is false `toBase64` options must be false as well.");if(d.order!==s.AllAtOnce)return[3,5];f=function(e,t){for(var n=[],r=a(e),i=Math.ceil(r.length/t),o=0;o<i;o++)n.push(r.splice(0,t));return n}(e,10),g=0,n.label=1;case 1:return g<f.length?[4,l(100)]:[3,5];case 2:return n.sent(),[4,Promise.all(f[g].map(h))];case 3:n.sent(),n.label=4;case 4:return g++,[3,1];case 5:if(d.order!==s.InOrder)return[3,12];p=0,m=e,n.label=6;case 6:if(!(p<m.length))return[3,12];v=m[p],n.label=7;case 7:return n.trys.push([7,10,,11]),[4,l(d.timeout)];case 8:return n.sent(),[4,h(v)];case 9:return n.sent(),[3,11];case 10:if(y=n.sent(),!d.shouldContinueOnFail)throw new Error(y);return[3,11];case 11:return p++,[3,6];case 12:return d.onComplete(),[2]}}))}))}},function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=0,n={},r=URL.createObjectURL(new Blob(["$$="+e+";onmessage="+function(e){Promise.resolve(e.data[1]).then((function(e){return $$.apply($$,e)})).then((function(t){postMessage([e.data[0],0,t],[t].filter((function(e){return e instanceof ArrayBuffer||e instanceof MessagePort||self.ImageBitmap&&e instanceof ImageBitmap})))}),(function(t){postMessage([e.data[0],1,""+t])}))}])),i=new Worker(r);return i.onmessage=function(e){n[e.data[0]][e.data[1]](e.data[2]),n[e.data[0]]=null},function(e){return e=[].slice.call(arguments),new Promise((function(){n[++t]=arguments,i.postMessage([t,e],e.filter((function(e){return e instanceof ArrayBuffer||e instanceof MessagePort||self.ImageBitmap&&e instanceof ImageBitmap})))}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomUtilities=void 0;var o=n(0),a=function(){function e(){}return e.hideImage=function(e,t){var n=t.document.getElementById(e.id);n&&(n.style.display="none")},e.hideImageSlow=function(e,t){return r(this,void 0,void 0,(function(){var n=this;return i(this,(function(o){return[2,new Promise((function(o,a){return r(n,void 0,void 0,(function(){var n,s,u,c,l=this;return i(this,(function(h){switch(h.label){case 0:return n=0,s=function(e){return new Promise((function(t){return setTimeout(t,e)}))},null!==(u=t.document.getElementById(e.id))?[3,1]:(a(!1),[3,3]);case 1:return c=Array.from({length:100},(function(e,t){return t})).map((function(){return r(l,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,s(100)];case 1:return e.sent(),u.style.opacity=(1-n/100).toString(),n++,[2]}}))}))})),[4,Promise.all(c)];case 2:h.sent(),u.style.display="none",o(!0),h.label=3;case 3:return[2]}}))}))}))]}))}))},e.showImage=function(e,t){var n=t.document.getElementById(e.id);if(!n)throw"could not find element with id "+e.id;n.style.display="block",n.style.removeProperty("z-index"),n.style.removeProperty("width"),n.style.removeProperty("position"),n.style.removeProperty("opacity"),n.style.removeProperty("filter")},e.cleanImage=function(e,t){var n=t.document.getElementById(e.id);if(!n)throw console.log("err"),"clean could not find element with id "+e.id;n.style.display="none"},e.getImageHolderElement=function(e,t,n){var r=e.document.createElement("div");return r.style.padding="0",r.style.margin="0",r.style.position="relative",r.id=n,r},e.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},e.getMainHolderElement=function(e,t){var n=t.document.getElementById(e);if(n instanceof HTMLDivElement)return n.style.position="relative",n;throw new o.default('Could not find main holder with id "'+e+'". Did you create an element like <div id="'+e+'"></div>')},e.getImageElement=function(e,t){var n=t.document.createElement("img");return n.src=e.encoded,n.id=e.id,n.style.userSelect="none",n.style.display="none",n},e}();t.DomUtilities=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=["textarea","input"],s=function(){function e(e,t){var n=this;this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.targets=[],this.prevTime=0,this.isDouble=!1,this.startRotate=0,this.onDragStart=function(e,t){if(void 0===t&&(t=!0),n.flag||e.cancelable){var i=n.options,s=i.container,u=i.pinchOutside,c=i.dragstart,l=i.preventRightClick,h=i.preventDefault,d=i.checkInput,f=n.isTouch;if(!n.flag){var g=document.activeElement,p=e.target,m=p.tagName.toLowerCase(),v=a.indexOf(m)>-1,y=p.isContentEditable;if(v||y){if(d||g===p)return!1;if(g&&y&&g.isContentEditable&&g.contains(p))return!1}else if((h||"touchstart"===e.type)&&g){var b=g.tagName;(g.isContentEditable||a.indexOf(b)>-1)&&g.blur()}}var w=0;if(!n.flag&&f&&u&&(w=setTimeout((function(){o.addEvent(s,"touchstart",n.onDragStart,{passive:!1})}))),n.flag&&f&&u&&o.removeEvent(s,"touchstart",n.onDragStart),f&&o.isMultiTouch(e)){if(clearTimeout(w),!n.flag&&e.touches.length!==e.changedTouches.length)return;n.pinchFlag||n.onPinchStart(e)}if(!n.flag){var _=n.startClients[0]?n.startClients:o.getPositionEvent(e);n.customDist=[0,0],n.flag=!0,n.isDrag=!1,n.startClients=_,n.prevClients=_,n.datas={},n.movement=0;var I=o.getPosition(_[0],n.prevClients[0],n.startClients[0]);if(e instanceof MouseEvent&&l&&(3===e.which||2===e.button))return clearTimeout(w),n.initDrag(),!1;!1===(c&&c(r({type:"dragstart",datas:n.datas,inputEvent:e,isTrusted:t},I)))&&(clearTimeout(w),n.initDrag()),n.isDouble=o.now()-n.prevTime<200,n.flag&&h&&e.preventDefault()}}},this.onDrag=function(e,t){if(n.flag){var i=o.getPositionEvent(e);n.pinchFlag&&n.onPinch(e,i);var a=n.move([0,0],e,i);if(a&&(a.deltaX||a.deltaY)){var s=n.options.drag;s&&s(r(r({},a),{isScroll:!!t,inputEvent:e}))}}},this.onDragEnd=function(e){if(n.flag){var t=n.options,i=t.dragend,a=t.pinchOutside,s=t.container;n.isTouch&&a&&o.removeEvent(s,"touchstart",n.onDragStart),n.pinchFlag&&n.onPinchEnd(e),n.flag=!1;var u=n.prevClients,c=n.startClients,l=n.pinchFlag?o.getPinchDragPosition(u,u,c,n.startPinchClients):o.getPosition(u[0],u[0],c[0]),h=o.now(),d=!n.isDrag&&n.isDouble;n.prevTime=n.isDrag||d?0:h,n.startClients=[],n.prevClients=[],i&&i(r({type:"dragend",datas:n.datas,isDouble:d,isDrag:n.isDrag,inputEvent:e},l))}};var i=[].concat(e);this.options=r({checkInput:!1,container:i.length>1?"undefined"!=typeof window?window:new HTMLDivElement:i[0],preventRightClick:!0,preventDefault:!0,pinchThreshold:0},t);var s=this.options,u=s.container,c=s.events;if(this.isTouch=c.indexOf("touch")>-1,this.isMouse=c.indexOf("mouse")>-1,this.customDist=[0,0],this.targets=i,this.isMouse&&(i.forEach((function(e){o.addEvent(e,"mousedown",n.onDragStart)})),o.addEvent(u,"mousemove",this.onDrag),o.addEvent(u,"mouseup",this.onDragEnd),o.addEvent(u,"contextmenu",this.onDragEnd)),this.isTouch){var l={passive:!1};i.forEach((function(e){o.addEvent(e,"touchstart",n.onDragStart,l)})),o.addEvent(u,"touchmove",this.onDrag,l),o.addEvent(u,"touchend",this.onDragEnd,l),o.addEvent(u,"touchcancel",this.onDragEnd,l)}}return e.prototype.move=function(e,t,n){var i=e[0],a=e[1];void 0===n&&(n=this.prevClients);var s=this.customDist,u=this.prevClients,c=this.startClients,l=this.pinchFlag?o.getPinchDragPosition(n,u,c,this.startPinchClients):o.getPosition(n[0],u[0],c[0]);s[0]+=i,s[1]+=a,l.deltaX+=i,l.deltaY+=a;var h=l.deltaX,d=l.deltaY;return l.distX+=s[0],l.distY+=s[1],this.movement+=Math.sqrt(h*h+d*d),this.prevClients=n,this.isDrag=!0,r(r({type:"drag",datas:this.datas},l),{movement:this.movement,isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},e.prototype.onPinchStart=function(e){var t,n,a=this.options,s=a.pinchstart,u=a.pinchThreshold;if(!(this.isDrag&&this.movement>u)){var c=o.getClients(e.changedTouches);if(this.pinchFlag=!0,(t=this.startClients).push.apply(t,c),(n=this.prevClients).push.apply(n,c),this.startDistance=o.getDist(this.prevClients),this.startPinchClients=i(this.prevClients),s){var l=this.prevClients,h=o.getAverageClient(l),d=o.getPosition(h,h,h);this.startRotate=o.getRotation(l),s(r(r({type:"pinchstart",datas:this.datas,angle:this.startRotate,touches:o.getPositions(l,l,l)},d),{inputEvent:e}))}}},e.prototype.onPinch=function(e,t){if(this.flag&&this.pinchFlag&&!(t.length<2)){this.isPinch=!0;var n=this.options.pinch;if(n){var i=this.prevClients,a=this.startClients,s=o.getPosition(o.getAverageClient(t),o.getAverageClient(i),o.getAverageClient(a)),u=o.getRotation(t),c=o.getDist(t);n(r(r({type:"pinch",datas:this.datas,movement:this.movement,angle:u,rotation:u-this.startRotate,touches:o.getPositions(t,i,a),scale:c/this.startDistance,distance:c},s),{inputEvent:e}))}}},e.prototype.onPinchEnd=function(e){if(this.flag&&this.pinchFlag){var t=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var i=this.prevClients,a=this.startClients,s=o.getPosition(o.getAverageClient(i),o.getAverageClient(i),o.getAverageClient(a));n(r(r({type:"pinchend",datas:this.datas,isPinch:t,touches:o.getPositions(i,i,a)},s),{inputEvent:e})),this.isPinch=!1,this.pinchFlag=!1}}},e.prototype.triggerDragStart=function(e){this.onDragStart(e,!1)},e.prototype.unset=function(){var e=this,t=this.targets,n=this.options.container;this.isMouse&&(t.forEach((function(t){o.removeEvent(t,"mousedown",e.onDragStart)})),o.removeEvent(n,"mousemove",this.onDrag),o.removeEvent(n,"mouseup",this.onDragEnd),o.removeEvent(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach((function(t){o.removeEvent(t,"touchstart",e.onDragStart)})),o.removeEvent(n,"touchstart",this.onDragStart),o.removeEvent(n,"touchmove",this.onDrag),o.removeEvent(n,"touchend",this.onDragEnd),o.removeEvent(n,"touchcancel",this.onDragEnd))},e.prototype.initDrag=function(){this.startClients=[],this.prevClients=[],this.flag=!1},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i={loadImage:r.slot(),started:r.slot(),startDragging:r.slot(),endAutoRotate:r.slot()};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.bar=t,this.p=e,this.refresh()}return e.prototype.refresh=function(){this.bar.style.width=this.p+"%"},e.prototype.update=function(e){this.p=e,this.refresh()},e}();t.default=r}])}));